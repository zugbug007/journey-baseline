---
title: Commercial Funnels
output:
  html_document:
    css: styles.css
---

### Membership {.tabset}

Insights:

#### Summary




#### Funnels
**Previous Week performance**

Membership funnel completions through the journey. This data is based on the VISITOR.

Start: **`r start_14_sun_start` to `r end_14_sun_end`**. 
```{r membership_funnel_pre, echo=FALSE}

# Journey Data steps, build each table based on shop, holidays, donate, membership event funnels.
# Before and after next to each other using patchwork. 
# Currently baseline for thi starts 14 days ago for the 7 days after. comparison starts 7 days back from today.

membership_fun_pre_plot

```

**Last 7 days funnel performance**
Hover over for fallout details at each stage.  

Start: **`r start_7_sun_start` to `r end_7_sun_end`**. 
```{r membership_funnel_post, echo=FALSE}

membership_fun_post_plot

```

**Previous Week performance**
This funnel includes the page directly before the start of the Membership funnel: Join Us Page.

Start: **`r start_14_sun_start` to `r end_14_sun_end`**. 
```{r membership_funnel_pre_start, echo=FALSE}

membership_fun_pre_plot_start

```

**Last 7 days funnel performance**
This funnel includes the page directly before the start of the Membership funnel: Join Us Page.

Start: **`r start_7_sun_start` to `r end_7_sun_end`**. 
```{r membership_funnel_post_start, echo=FALSE}


```

#### Sales & Revenue




#### Metrics
```{r membership_metrics}
mpg_list <- split(mtcars$mpg, mtcars$cyl)
disp_list <- split(mtcars$disp, mtcars$cyl)
inline_plot <- data.frame(cyl = c(4, 6, 8), mpg_box = "", mpg_hist = "",
                          mpg_line1 = "", mpg_line2 = "",
                          mpg_points1 = "", mpg_points2 = "", mpg_poly = "")
inline_plot %>%
  kbl(booktabs = TRUE) %>%
  kable_paper(full_width = FALSE) %>%
  column_spec(2, image = spec_boxplot(mpg_list)) %>%
  column_spec(3, image = spec_hist(mpg_list)) %>%
  column_spec(4, image = spec_plot(mpg_list, same_lim = TRUE)) %>%
  column_spec(5, image = spec_plot(mpg_list, same_lim = FALSE)) %>%
  column_spec(6, image = spec_plot(mpg_list, type = "p")) %>%
  column_spec(7, image = spec_plot(mpg_list, disp_list, type = "p")) %>%
  column_spec(8, image = spec_plot(mpg_list, polymin = 5))

# https://cranky-chandrasekhar-cfefcd.netlify.app/
# https://haozhu233.github.io/kableExtra/awesome_table_in_html.html#Row_spec
```



#### Flows

Membership conversions by Channel. Start: **`r previous_week_7_start` to `r previous_week_7_end`**. 

```{r membership_flow_scatter_plot, echo=FALSE, fig.height=7, fig.width=9, warning=FALSE}
membership_conv_scatter_plot  
membership_conv_flow_plot
```


#### Change Point

This plot shows the change in the mean visits through the funnel over the series.  
Change point occurred on day: **`r fit_changepoint_membership@cpts[1]`**.

```{r membership_changepoints, echo=FALSE}


plot(fit_changepoint_membership)

```

### {-}


### Renewals {.tabset}

Insights:

#### Summary


#### Funnels



#### Sales & Revenue




#### Metrics



#### Flows
Renewals conversions by Channel. Start: **`r previous_week_7_start` to `r previous_week_7_end`**. 

```{r renewals_flow_scatter_plot, warning=FALSE,echo=FALSE, fig.height=7, fig.width=9, fig.align='center'}

membership_renewals_conv_scatter_plot  
membership_renewals_conv_flow_plot

```

#### Change Point


This plot shows the change in the mean visits through the funnel over the series.  
Change point occurred on day: **`r fit_changepoint_renew@cpts[1]`**.


```{r renew_changepoints, echo=FALSE}


plot(fit_changepoint_renew)


```




### {-}


### Holidays {.tabset}

Insights:

#### Summary


#### Funnels



#### Sales & Revenue




#### Metrics



#### Flows
```{r holidays_flow_scatter_plot, warning=FALSE,echo=FALSE, fig.height=7, fig.width=9, fig.align='center'}

holidays_conv_scatter_plot  
holidays_conv_flow_plot

```


#### Change Point

This plot shows the change in the mean visits through the funnel over the series.  
Change point occurred on day: **`r fit_changepoint_holidays@cpts[1]`**.

```{r holidays_changepoints, echo=FALSE}

plot(fit_changepoint_holidays)

```


### {-}


### Shop {.tabset}

Insights:

[Min] The lowest amount of Shop - Order Step 4 - Order Confirmation (Serialized) (ev182) was 15, which occurred on Feb. 3rd and was 84% less than the average of 92.

#### Summary


```{r shop_summary, ECHO=FALSE}
head(mtcars)
```


#### Funnels

Shop funnel completions through the journey. This data is 

Start: **`r start_14_sun_start` to `r end_14_sun_end`**. 
```{r shop_funnel_pre, echo=FALSE}

# Journey Data steps, build each table based on shop, holidays, donate, membership event funnels.
# Before and after next to each other using patchwork. 
# Currently baseline for thi starts 14 days ago for the 7 days after. comparison starts 7 days back from today.

shop_fun_pre_plot

```

**Last 7 days funnel performance**
Hover over for fallout details at each stage.  

Start: **`r start_7_sun_start` to `r end_7_sun_end`**. 
```{r shop_funnel_post, echo=FALSE}

shop_fun_post_plot

```

#### Sales & Revenue

Here is the individual trends for each metric in the shop funnel.

Revenue:

```{r shop_revenue, echo=FALSE, fig.height=7, fig.width=9}

ggplotly(shop_revenue)

```
Shop Orders:  

Shop - Order Step 4 - Order Confirmation (Serialized) (ev182)
```{r shop_orders, echo=FALSE, fig.height=7, fig.width=9}

ggplotly(shop_orders)

```


#### Metrics

Here is the individual trends for shop sales.
Add Revenue events too.

```{r shop_metrics, echo=FALSE}
# Anomaly Plots for each journey with Ribbon and Pre/Post separations
shop_events

```

#### Flows
Shop conversions by Channel. Start: **`r previous_week_7_start` to `r previous_week_7_end`**. 

```{r shop_flow_scatter_plot, warning=FALSE,echo=FALSE, fig.height=7, fig.width=9, fig.align='center'}

shop_conv_scatter_plot  
shop_conv_flow_plot

```


#### Change Point

This plot shows the change in the mean visits through the funnel over the series.  
Change point occurred on day: **`r fit_changepoint_shop@cpts[1]`**.

```{r shop_changepoints, echo=FALSE}

plot(fit_changepoint_shop)

```




### {-}

### Donate {.tabset}

Insights:

#### Summary


#### Funnels



#### Sales & Revenue




#### Metrics



#### Flows
Donate conversions by Channel. Start: **`r previous_week_7_start` to `r previous_week_7_end`**. 

```{r donate_flow_scatter_plot, warning=FALSE,echo=FALSE, fig.height=7, fig.width=9, fig.align='center'}

donate_conv_scatter_plot  
donate_conv_flow_plot

```


#### Change Point
This plot shows the change in the mean visits through the funnel over the series.  
Change point occurred on day: **`r fit_changepoint_donate@cpts[1]`**.

```{r donate_changepoints, echo=FALSE}

plot(fit_changepoint_donate)

```




### {-}
